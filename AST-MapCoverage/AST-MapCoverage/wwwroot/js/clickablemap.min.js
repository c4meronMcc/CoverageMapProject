document.addEventListener('DOMContentLoaded', function () {
    const mapElement = document.getElementById('map');
    const svgPath = '/SVGMapOverlays.svg';



    function loadSvgFile() {
        fetch(svgPath)
            .then(response => response.text())
            .then(svgText => {
                mapElement.innerHTML = svgText;
                addEventListeners();
                initializePanZoom();
            }).then(() => {
                //adding a click event listener to SVG paths
                document.querySelectorAll('path').forEach(function (path) {
                    //Initialized the clicked state for each path

                    console.log("adding event listener")
                    path.isClicked = false;

                    path.addEventListener('click', () => {
                        //giving the country name a variable
                        const layerName = path.getAttribute('vectornator:layername');
                        //giving the svgs id a variable
                        const SvgID = path.getAttribute('id');

                        //giving each image a variable
                        const GlobalVSATcoverage = document.getElementById('GlobalVSATcoverage');
                        const InmarsatGlobalXpress = document.getElementById('InmarsatGlobalXpress');
                        const InmarsatFleetBroadband = document.getElementById('InmarsatFleetBroadband');
                        const Thuraya = document.getElementById('Thuraya');

                        //text parts within country info
                        const Header = document.getElementById('CountryHeader');
                        const Text1 = document.getElementById('Text1');
                        const Text2 = document.getElementById('Text2');

                        //deciding what images are being shown based on the id that it has
                        if (SvgID == "All") {
                            document.getElementById("CountryInfo").style.display = "block";

                            //making sure that the images display is they are currently off
                            Thuraya.style.display = "block";
                            InmarsatFleetBroadband.style.display = "block";
                            InmarsatGlobalXpress.style.display = "block";
                            GlobalVSATcoverage.style.display = "block";

                            //changing the text and headers to fit the country Selected
                            Header.innerHTML = layerName;
                            Text1.innerHTML = "If you're looking for coverage over "+ layerName +" then you have 5 options! Your options for coverage over "+ layerName + " are found below"
                            Text2.innerHTML = "This is what the different coverage areas look like for "+ layerName +" click on a coverage area if you want to see infomation about them."
                        }
                        if (SvgID == "I-G-IG-IF") {
                            document.getElementById("CountryInfo").style.display = "block";

                            //not displaying the images that we dont want
                            Thuraya.style.display = "none";
                            InmarsatFleetBroadband.style.display = "block";
                            InmarsatGlobalXpress.style.display = "block";
                            GlobalVSATcoverage.style.display = "block";

                            //changing the text and headers to fit the country Selected
                            Header.innerHTML = layerName;
                            Text1.innerHTML = "If you're looking for coverage over " + layerName + " then you have 4 options! Your options for coverage over " + layerName + " are found below"
                            Text2.innerHTML = "This is what the different coverage areas look like for " + layerName + " click on a coverage area if you want to see infomation about them."
                        }
                        if (SvgID == "I-IG") {
                            document.getElementById("CountryInfo").style.display = "block";

                            //not displaying the images that we dont want
                            Thuraya.style.display = "none";
                            InmarsatFleetBroadband.style.display = "none";
                            InmarsatGlobalXpress.style.display = "block";
                            GlobalVSATcoverage.style.display = "none";

                            //changing the text and headers to fit the country Selected
                            Header.innerHTML = layerName;
                            Text1.innerHTML = "If you're looking for coverage over " + layerName + " then you have 2 options! Your options for coverage over " + layerName + " are found below"
                            Text2.innerHTML = "This is what the different coverage areas look like for " + layerName + " click on a coverage area if you want to see infomation about them."
                        }
                        //alert(layerName);
                        

                        
                    })

         

                });
            })
            .catch(error => console.error('Failed to load SVG file:', error));

    }

    // Add a click event listener to SVG paths
    document.querySelectorAll('#allLand path').forEach(function (path) {
        path.addEventListener('click', function () {
            // Toggle the clicked state for the current path
            this.isClicked = !this.isClicked;

            // Set the fill color based on the clicked state
            if (this.isClicked) {
                this.setAttribute('fill', '#8A9A5B');
                console.log("hello");
            } else {
                this.setAttribute('fill', '');
            }
        });
    });

    function addEventListeners() {
        const paths = mapElement.querySelectorAll('path');
        paths.forEach(path => {
            path.addEventListener('click', function () {
                resetCountryColors();
                this.classList.add('clicked');
            });
        });
    }

    function resetCountryColors() {
        const clickedPaths = mapElement.querySelectorAll('.clicked');
        clickedPaths.forEach(path => {
            path.classList.remove('clicked');
        });
    }

    function initializePanZoom() {
        const mapSvg = mapElement.querySelector('svg');
        const panZoomMap = svgPanZoom(mapSvg, {
            zoomEnabled: true,
            controlIconsEnabled: true,
            fit: true,
            center: true,
        });

        function resizePanZoomContainer() {
            const mapRect = mapSvg.getBoundingClientRect();
            panZoomMap.resize(mapRect.width, mapRect.height);
        }

        // Resize the container initially
        resizePanZoomContainer();

        // Resize the container when the window is resized
        window.addEventListener('resize', resizePanZoomContainer);
    }




    var listOfPaths = document.querySelectorAll('path');
    console.log(listOfPaths)

    loadSvgFile();
});